{% extends "base.html" %}

{% block title %}Nueva factura{% endblock %}

{% block content %}
<div class="card">
    <div class="actions">
        <a class="btn btn-secondary" href="/invoices">← Volver a facturas</a>
    </div>
    <h2>Nueva factura (borrador)</h2>
    <form action="{{ form_action }}" method="post">
        <div class="field">
            <label for="client_id">Cliente</label>
            <select id="client_id" name="client_id" required>
                <option value="">Selecciona...</option>
                {% for client in clients %}
                    <option value="{{ client.id }}" {% if data.client_id|int == client.id %}selected{% endif %}>{{ client.name }}</option>
                {% endfor %}
            </select>
            {% if errors.client_id %}<div class="error">{{ errors.client_id }}</div>{% endif %}
        </div>
        <div class="field">
            <label for="issue_date">Fecha de emisión</label>
            <input type="date" id="issue_date" name="issue_date" value="{{ data.issue_date }}">
            {% if errors.issue_date %}<div class="error">{{ errors.issue_date }}</div>{% endif %}
        </div>
        <div class="field">
            <label for="currency">Moneda</label>
            <input type="text" id="currency" name="currency" value="{{ data.currency }}">
        </div>
        <div class="field">
            <label for="igi_rate">IGI %</label>
            <input type="number" step="0.01" min="0" id="igi_rate" name="igi_rate" value="{{ data.igi_rate }}">
            {% if errors.igi_rate %}<div class="error">{{ errors.igi_rate }}</div>{% endif %}
        </div>
        <div class="field">
            <label for="notes">Notas</label>
            <textarea id="notes" name="notes" rows="3">{{ data.notes }}</textarea>
        </div>
        <button class="btn btn-primary" type="submit">Crear borrador</button>
    </form>
</div>
{% endblock %}
